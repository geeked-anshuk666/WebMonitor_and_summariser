generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Link {
  id          String    @id @default(cuid())
  url         String    @unique
  label       String?
  tags        String?
  createdAt   DateTime  @default(now())
  lastChecked DateTime?
  checks      Check[]
}

model Check {
  id          String   @id @default(cuid())
  linkId      String
  link        Link     @relation(fields: [linkId], references: [id], onDelete: Cascade)
  checkedAt   DateTime @default(now())
  contentHash String
  rawText     String?  @db.Text
  diff        String?  @db.Text
  summary     String?  @db.Text
  hasChanges  Boolean  @default(false)
  snippet     String?
  error       String?

  @@index([linkId, checkedAt(sort: Desc)])
}
